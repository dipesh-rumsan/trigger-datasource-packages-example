enum SourceType {
  RAINFALL
  WATER_LEVEL
  @@schema("public")
}

enum DataSource {
  DHM
  GLOFAS
  MANUAL
  DAILY_MONITORING
  GFH
  @@schema("public")
}

model Source {
  id         Int          @id @default(autoincrement())
  uuid       String       @unique @default(uuid())
  source     DataSource[]
  riverBasin String       @unique
  createdAt  DateTime     @default(now())
  updatedAt  DateTime?    @updatedAt()

  SourcesData       SourcesData[]
  DailyMonitoring   DailyMonitoring[]
  Phase             Phase[]
  SourceBlockchain  SourceBlockchain?

  @@map("tbl_sources")
  @@schema("public")
}

model SourcesData {
  id Int @id @default(autoincrement())

  type       SourceType
  sourceId   Int
  source     Source      @relation(fields: [sourceId], references: [id])
  dataSource DataSource?

  info Json @db.JsonB()

  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt()

  @@map("tbl_sources_data")
  @@schema("public")
}

model DailyMonitoring {
  id       Int     @id @default(autoincrement())
  groupKey String?

  dataEntryBy String
  info        Json   @db.JsonB()

  sourceId Int
  source   Source @relation(fields: [sourceId], references: [id])

  dataSource String?
  isDeleted  Boolean   @default(false)
  createdBy  String?
  createdAt  DateTime  @default(now())
  updatedAt  DateTime? @updatedAt()

  @@map("tbl_daily_monitoring")
  @@schema("public")
}

model SourceBlockchain {
  id             Int      @id @default(autoincrement())
  sourceId       Int      @unique
  source         Source   @relation(fields: [sourceId], references: [id])
  transactionHash String
  blockchainId   String
  chain          String   @default("evm")
  createdAt      DateTime @default(now())
  updatedAt      DateTime? @updatedAt()

  @@map("tbl_source_blockchain")
  @@schema("public")
}