model Trigger {
    id   Int    @id @default(autoincrement())
    uuid String @unique @default(uuid())

    repeatKey   String  @unique
    repeatEvery String?

    triggerStatement Json?   @db.JsonB()
    triggerDocuments Json?   @db.JsonB()
    notes            String?
    title            String?
    description      String?

    phase   Phase?      @relation(fields: [phaseId], references: [uuid])
    phaseId String?
    source  DataSource?

    isMandatory      Boolean @default(false)
    isTriggered      Boolean @default(false)
    isDeleted        Boolean @default(false)
    isDailyMonitored Boolean @default(false)

    createdBy       String?
    triggeredBy     String?
    transactionHash String?

    triggeredAt DateTime?
    createdAt   DateTime  @default(now())
    updatedAt   DateTime? @updatedAt()

    @@schema("public")
    @@map("tbl_triggers")
}

model TriggerHistory {
    id   Int    @id @default(autoincrement())
    uuid String

    repeatKey   String
    repeatEvery String?

    triggerStatement Json?   @db.JsonB()
    triggerDocuments Json?   @db.JsonB()
    notes            String?
    title            String?
    description      String?

    phase   Phase?  @relation(fields: [phaseId], references: [uuid])
    phaseId String?

    phaseActivationDate DateTime?
    version             Int

    source           DataSource?
    isMandatory      Boolean     @default(false)
    isTriggered      Boolean     @default(false)
    isDeleted        Boolean     @default(false)
    isDailyMonitored Boolean     @default(false)

    triggeredBy     String?
    transactionHash String?

    triggeredAt DateTime?
    createdAt   DateTime  @default(now())
    createdBy   String?
    updatedAt   DateTime? @updatedAt()

    revertedAt DateTime
    revertedBy String

    @@map("tbl_trigger_history")
    @@schema("public")
}
